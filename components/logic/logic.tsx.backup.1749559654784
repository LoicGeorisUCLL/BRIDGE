import { UserProfile } from "@/types";

export const generatePersonalizedTasks = (profile: UserProfile): string[] => {
  const allTasks = [];

  console.log('Generating tasks for profile:', profile.answers);

  // Check if the user is an EU or non-EU citizen
  const isEUCitizen = profile.answers[0] === 0;

  // Check if the user will be working in Belgium for more than 3 months
  const isLongTermStay = profile.answers[1] === 1;

  // Check if the user has a valid work contract
  const hasValidContract = profile.answers[2] === 0;

  // Check if the user has health insurance coverage
  const hasHealthInsurance = profile.answers[3] === 0;

  // Check if the user has a bank account in Belgium
  const hasBankAccount = profile.answers[4] === 0;

  // Check if the user is at least 25 years old
  const isAtLeast25 = profile.answers[5] === 0;

  // All seasonal workers staying for more than 3 months must be registered with the local authorities (municipal_registration)
  if (isLongTermStay) {
    allTasks.push('municipal_registration');
  }

  // All seasonal workers must have a valid work contract issued by their employer (work_contract_acquisition)
  allTasks.push('work_contract_acquisition');

  // All seasonal workers must have health insurance coverage for the duration of their stay (health_insurance_enrollment)
  allTasks.push('health_insurance_enrollment');

  // All seasonal workers must have a bank account in the country of employment to receive their wages (bank_account_setup)
  allTasks.push('bank_account_setup');

  // All seasonal workers must be at least 25 years old (age_verification)
  if (!isAtLeast25) {
    allTasks.push('age_verification');
  }

  // Always add Annex 3 (bijlage3) for temporary residence document
  allTasks.push('bijlage3');

  // Always add emergency contact setup
  allTasks.push('emergency');

  return allTasks;
};
